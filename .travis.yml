language: c

addons:
  apt:
    update: true
    packages:
      - make
      - libtool
      - pkg-config
      - autoconf
      - texinfo
      - gcc-arm-linux-gnueabihf

before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -y gcc-arm-linux-gnueabihf
    - arm-linux-gnueabihf-gcc --version
    - sudo apt-get -y install bc
    - sudo apt-get install build-essential
    - sudo apt-get install g++-arm-linux-gnueabihf
    - sudo apt-get install gdb-multiarc
    - if [ `uname -m` = x86_64 ]; then sudo apt-get install libc6-i386 lib32stdc++6 lib32z1; fi

   


install:
    - gem install --no-ri --no-rdoc fpm

script:
    - export ARCH=arm
    - export CROSS_COMPILE=arm-linux-gnueabihf-
    - echo "CONFIG_MODULES=y" >> arch/arm/configs/multi_v7_defconfig
    - echo "CONFIG_MODULE_UNLOAD=y" >> arch/arm/configs/multi_v7_defconfig
    - ./make_deb.sh
    


# deploy:
#   provider: releases
#   api_key: $GITHUB_TOKEN
#   file: '*.deb'
#   file_glob: true
#   skip_cleanup: true
#   name: $TRAVIS_TAG
#   on:
#     branch: master
# tags: true
